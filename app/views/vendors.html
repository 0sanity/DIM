<div class="vendor" ng-controller="dimVendorCtrl as vm">
  <a ui-sref='inventory' class="link"><i class='fa fa-arrow-circle-left'></i>Back to DIM</a>
  <h1 class="orange">Vendors</h1>
  <div class="vendor">
    <div class="vendor-block" ng-repeat="(idx, vendorHash) in vm.vendorHashes">
      <div ng-if="vm.vendors[0][vendorHash]">
        <div class="vendor-header">
          <div class="title">
          {{vm.vendors[0][vendorHash].vendorName}}
          <img class="vendor-icon" ng-src="{{vm.vendors[0][vendorHash].vendorIcon}}" />
          <timer ng-if="!vm.vendors[0][vendorHash].nextRefreshDate.startsWith('9999')" style="float:right" end-time="vm.vendors[0][vendorHash].nextRefreshDate" max-time-unit="'day'" interval="1000">{{days}} day{{daysS}} {{hhours}}:{{mminutes}}:{{sseconds}}</timer>
          </div>
        </div>
        <div class="vendor-row">
          <div class="vendor-category" ng-repeat="(idx, vendors) in vm.vendors">
            <div class="vendor-item" ng-repeat="saleItem in vendors[vendorHash].items">
              <dim-simple-item  id="vendor-{{::saleItem.hash}}" item-data="saleItem" ng-click="vm.itemClicked(saleItem, $event)" ng-class="{ 'search-hidden': !saleItem.visible }"></dim-simple-item>
              <div class="cost" ng-class="{notenough: (vm.totalCoins[saleItem.cost.currency.itemHash] < saleItem.cost.cost)}">
                {{::vendors[vendorHash].costs[saleItem.hash].cost}}/{{vm.totalCoins[vendors[vendorHash].costs[saleItem.hash].currency.itemHash]}}
                <span class="currency"><img dim-bungie-image-fallback="::vendors[vendorHash].costs[saleItem.hash].currency.icon" title="{{::vendors[vendorHash].costs[saleItem.itemHash].currency.name}}"></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
